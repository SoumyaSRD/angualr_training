<div class="app-container" [class.dark-theme]="themeService.isDarkSelected()">
  <!-- ┌──────────────────────────────────────────────────────┐ -->
  <!-- │                      Toolbar                         │ -->
  <!-- └──────────────────────────────────────────────────────┘ -->
  <mat-toolbar class="app-toolbar mat-elevation-z3">
    <div class="toolbar-content">
      <!-- Left: Menu + Brand -->
      <div class="toolbar-left">
        <button mat-icon-button (click)="drawer.toggle()" matTooltip="Toggle menu"
          aria-label="Toggle navigation drawer">
          <mat-icon [ngStyle]="{ color: toolbarIconColor() }">menu</mat-icon>
        </button>

        <div class="brand-section" routerLink="/" role="button" tabindex="0">
          <mat-icon class="brand-icon">code</mat-icon>
          <div class="brand-text">
            <span class="app-title">Angular Academy</span>
            <span class="app-subtitle">Professional Training</span>
          </div>
        </div>
      </div>

      <!-- Center: empty / can be used for page title or search later -->
      <div class="toolbar-center"></div>

      <!-- Right: Theme + User menu -->
      <div class="toolbar-right">
        <!-- Theme toggle -->
        <button mat-icon-button (click)="themeService.toggleTheme()" matTooltip="Toggle theme"
          aria-label="Toggle light/dark theme">
          <mat-icon [ngStyle]="{ color: toolbarIconColor() }">{{
            themeService.isDarkSelected() ? 'dark_mode' : 'light_mode'
            }}</mat-icon>
        </button>

        <!-- User menu (placeholder – connect to real auth later) -->
        <button [ngStyle]="{ color: toolbarIconColor() }" mat-button [matMenuTriggerFor]="userMenu"
          class="user-menu-button" aria-label="User account menu">
          <mat-icon>account_circle</mat-icon>
          <span class="user-name-label">{{ authService.username() }}</span>
        </button>

        <mat-menu #userMenu="matMenu">
          <button mat-menu-item disabled>
            <mat-icon>person</mat-icon>
            <span>User</span>
          </button>
          <mat-divider></mat-divider>
          <button mat-menu-item routerLink="/profile">
            <mat-icon>settings</mat-icon>
            <span>Profile & Settings</span>
          </button>
          @if (authService.isLoggedIn()) {
          <button mat-menu-item (click)="logout()">
            <mat-icon>logout</mat-icon>
            <span>Sign out</span>
          </button>
          } @else {
          <button mat-menu-item (click)="login()">
            <mat-icon>login</mat-icon>
            <span>Sign in</span>
          </button>
          }
        </mat-menu>
      </div>
    </div>
  </mat-toolbar>

  <!-- ┌──────────────────────────────────────────────────────┐ -->
  <!-- │               Sidenav + Main Content                 │ -->
  <!-- └──────────────────────────────────────────────────────┘ -->
  <mat-sidenav-container class="sidenav-container">
    <mat-sidenav #drawer [mode]="isHandset() ? 'over' : 'side'" [opened]="!isHandset()"
      class="sidenav mat-elevation-z2">
      <div class="sidenav-content">
        <mat-accordion multi class="navigation-accordion">
          @for (topic of navigationService.topics; track topic.title) {
          <mat-expansion-panel [expanded]="isTopicExpanded(topic)">
            <mat-expansion-panel-header class="panel-header">
              <mat-panel-title class="panel-title">
                <mat-icon class="topic-icon" [class.active]="isTopicExpanded(topic)">
                  {{ topic.icon }}
                </mat-icon>
                <span class="topic-title">{{ topic.title }}</span>
              </mat-panel-title>
            </mat-expansion-panel-header>

            <mat-nav-list dense class="subtopic-list">
              @for (sub of topic.subTopics; track sub.route) {
              <a mat-list-item [routerLink]="sub.route" routerLinkActive="active"
                [routerLinkActiveOptions]="{ exact: true }" (click)="closeDrawerIfMobile()" class="subtopic-item">
                <div [ngStyle]="{ color: toolbarIconColor() }">
                  <mat-icon class="subtopic-icon">chevron_right</mat-icon>
                  <span class="subtopic-title">
                    {{ sub.title }}
                  </span>
                  @if (isCompleted(sub.route)) {
                  <mat-icon class="completed-icon" color="primary">check_circle</mat-icon>
                  }
                </div>
              </a>

              }
            </mat-nav-list>
          </mat-expansion-panel>
          }
        </mat-accordion>
      </div>
    </mat-sidenav>

    <mat-sidenav-content class="main-content">
      <!-- Breadcrumb -->
      <div class="breadcrumb">
        <a routerLink="/" class="breadcrumb-home" matTooltip="Home">
          <mat-icon>home</mat-icon>
        </a>
        <mat-icon class="breadcrumb-separator">chevron_right</mat-icon>
        <span class="breadcrumb-item">{{ currentPageTitle() }}</span>
      </div>

      <!-- Page content -->
      <div class="content-wrapper">
        <router-outlet></router-outlet>
      </div>

      <!-- Footer -->
      <footer class="app-footer">
        <div class="footer-content">
          <div>
            <h3 class="footer-title">Angular Academy</h3>
            <p class="footer-description">
              Professional Angular training — January 2026
            </p>
          </div>

          <div>
            <h4 class="footer-subtitle">Resources</h4>
            <div class="footer-links">
              <a href="https://angular.dev" target="_blank" rel="noopener" class="footer-link">
                <mat-icon>description</mat-icon> angular.dev
              </a>
              <a href="https://github.com/angular" target="_blank" rel="noopener" class="footer-link">
                <mat-icon>code</mat-icon> GitHub
              </a>
            </div>
          </div>

          <div>
            <h4 class="footer-subtitle">Support</h4>
            <div class="footer-links">
              <a href="mailto:support@angularacademy.com" class="footer-link">
                <mat-icon>mail</mat-icon> support@angularacademy.com
              </a>
            </div>
          </div>
        </div>

        <div class="footer-bottom">
          <p class="copyright">© 2026 Angular Academy</p>
          <div class="social-links">
            <a href="#" class="social-link" aria-label="Twitter"><mat-icon>twitter</mat-icon></a>
            <a href="#" class="social-link" aria-label="GitHub"><mat-icon>code</mat-icon></a>
          </div>
        </div>
      </footer>
    </mat-sidenav-content>
  </mat-sidenav-container>
</div>